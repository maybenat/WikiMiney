<script src="https://code.jquery.com/jquery-2.1.3.min.js">
</script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/drilldown.js"></script>
</script>
<script>
$(function() {
    var pages, jsonData, frequencies, drilldownSeries, pagesData, date, dayData;

    var json = $.getJSON("http://localhost:3000/data/year/2008/month/10/top/10", function() {
        jsonData = json.responseJSON;
        console.log(jsonData);
        arr = [];
        frequencies = [];
        pages = [];
        pagesData = [];
        drilldownSeries = [];
        date = [];
        dayData = [];

        for (var j in jsonData) {
            pages[j] = jsonData[j].page;
            test = [];
            test = jsonData[j].wikiviews[0].views;
            frequencies[j] = test;

            for (var k in jsonData[j].wikiviews) {
                //console.log(jsonData[j].wikiviews[k].views);
                if (!date[jsonData[j].page]) {
                    date[jsonData[j].page] = [];
                }
                var day = jsonData[j].wikiviews[k].day;
                console.log(day);
                date[jsonData[j].page].push(day, jsonData[j].wikiviews[k].views);
                if (!dayData[jsonData[j].page]) {
                    dayData[jsonData[j].page] = [];
                }
                var numViews = jsonData[j].wikiviews[k].views;

                dayData[jsonData[j].page].push(numViews);

                drilldownSeries.push({
                    name: pages[j],
                    id: pages[j],
                    data: dayData[jsonData[j].page]
                });

            }

            pagesData.push({
                name: pages[j],
                y: frequencies[j],
                drilldown: date[pages[j]] ? pages[j] : null
            });

        }

        console.log(dayData["Sarah_Palin"]);
        // Create the chart
        $('#container').highcharts({
            chart: {
                type: 'column'
            },
            title: {
                text: 'Wiki Views'
            },
            // xAxis: {
            //     type: 'category'
            // },
            yAxis:
            {
                title: {
                        text: 'Total Views'
                    }
                },

            legend: {
                enabled: true
            },

            plotOptions: {
                spline: {
                    shadow: false,
                    marker: {
                        radius: 1
                    }
                },
                areaspline: {
                    color: 'rgb(69, 114, 167)',
                    fillColor: 'rgba(69, 114, 167,.25)',
                    shadow: false,
                    marker: {
                        radius: 1
                    }

                },
                series: {
                    borderWidth: 0,
                    dataLabels: {
                        enabled: true
                    }
                }
            },

            series: [{
                name: 'Frequencies',
                colorByPoint: true,
                data: pagesData,
            // }],
            }, {
                name: 'Curve',
                type: 'spline',
                visible: false,
                data: frequencies,
                //color: 'rgba(204,204,255,.85)'
            }, {
                name: 'Filled Curve',
                type: 'areaspline',
                visible: false,
                data: frequencies,
                //color: 'rgba(204,204,255,.85)'
            }],
            drilldown: {
                series: drilldownSeries
            }
        });
    })


});
</script>
<div id="container" style="height: 400px; min-width: 310px"></div>